<task>
  <metadata>
    <phase>4</phase>
    <title>Knowledge Systems Implementation</title>
    <timeline>Days 17-20</timeline>
    <token_budget>100K</token_budget>
    <agent_persona>knowledge engineer + domain expert</agent_persona>
    <complexity>medium</complexity>
    <dependencies>Phase 3 frontend must support knowledge integration</dependencies>
  </metadata>

  <instructions>
    You are implementing Phase 4 of the OKR AI Agent project. Your role combines knowledge engineering expertise with domain specialization in OKR best practices. This phase transforms the functional conversation system into an intelligent coaching agent through comprehensive knowledge systems that provide contextual examples, detect patterns, and guide users with expert-level insights.

    CRITICAL SUCCESS CRITERIA:
    - Comprehensive knowledge base with industry-specific OKR examples and anti-patterns
    - Intelligent example selection based on user context and conversation phase
    - Metrics suggestion engine providing relevant measurement ideas
    - Template system for common OKR patterns across industries and functions
    - Seamless integration with conversation flow enhancing rather than interrupting dialogue
  </instructions>

  <context>
    <phase_3_outcomes>
      Frontend completed successfully:
      - Professional React application with real-time chat interface
      - OKR display panel with quality score visualization
      - Export system generating professional outputs
      - Responsive design working on desktop and tablet
      - Accessibility compliance verified
      - Integration points prepared for knowledge system enhancement
    </phase_3_outcomes>

    <knowledge_system_requirements>
      CORE CHALLENGE: Convert the basic conversation engine into an expert-level OKR coach by providing:

      1. **Contextual Examples**: Show relevant good/bad OKR pairs based on user's industry and function
      2. **Anti-Pattern Intelligence**: Detect specific mistakes and provide targeted explanations
      3. **Metric Suggestions**: Offer measurement ideas when users struggle with quantification
      4. **Template Guidance**: Provide starting points for common OKR scenarios
      5. **Best Practice Integration**: Weave expert knowledge naturally into conversation flow

      DESIGN PHILOSOPHY:
      - **Context-Aware**: All suggestions based on user's specific situation (industry, function, role)
      - **Progressive Disclosure**: Show information when needed, avoid overwhelming
      - **Example-Driven**: Concrete examples more effective than abstract explanations
      - **Pattern Recognition**: Learn what works for different user types and contexts
      - **Natural Integration**: Knowledge appears as helpful coaching, not database dumps
    </knowledge_system_requirements>

    <conversation_enhancement_goals>
      Transform these common interaction patterns:

      BEFORE (Phase 2): Generic responses
      User: "We need to launch our mobile app"
      AI: "That sounds like a project milestone. What change will the app create?"

      AFTER (Phase 4): Contextual coaching with examples
      User: "We need to launch our mobile app"
      AI: "That sounds like a project milestone. Let me show you how other [tech companies / retail businesses / healthcare organizations] have turned app launches into meaningful OKRs. For example, instead of 'Launch mobile app,' Shopify focused on 'Empower merchants with anywhere access' and measured 'Increase mobile transaction volume from 30% to 60%.' What change will your app create for users?"

      This requires intelligent context detection, relevant example selection, and natural integration.
    </conversation_enhancement_goals>
  </context>

  <phase_deliverables>
    <deliverable priority="critical">
      <title>Comprehensive Knowledge Base</title>
      <description>Structured collection of OKR examples, anti-patterns, and best practices organized by context</description>
      <knowledge_structure>
        <examples_library>
          data/knowledge/examples/
          ├── by_industry/
          │   ├── technology.json           # SaaS, fintech, AI/ML, cybersecurity
          │   ├── retail_ecommerce.json    # E-commerce, marketplace, consumer goods
          │   ├── healthcare.json          # Healthcare providers, medtech, pharma
          │   ├── financial_services.json  # Banking, insurance, investment
          │   ├── manufacturing.json       # Industrial, automotive, aerospace
          │   └── professional_services.json # Consulting, legal, marketing agencies
          ├── by_function/
          │   ├── product_engineering.json # Product management, software development
          │   ├── sales_marketing.json     # Revenue, customer acquisition, branding
          │   ├── customer_success.json    # Retention, satisfaction, support
          │   ├── operations_hr.json       # Efficiency, talent, culture
          │   └── executive_leadership.json # Strategy, transformation, governance
          └── universal/
              ├── outcome_examples.json    # Cross-industry outcome patterns
              ├── measurement_patterns.json # Common metric categories
              └── transformation_stories.json # Before/after case studies
        </examples_library>

        <anti_patterns_database>
          data/knowledge/anti_patterns/
          ├── detection_rules.json        # Regex and keyword patterns for identification
          ├── common_mistakes.json        # Catalog of frequent errors with explanations
          ├── reframing_examples.json     # Before/after transformations by pattern type
          └── context_specific.json       # Industry-specific anti-patterns
        </anti_patterns_database>

        <metrics_library>
          data/knowledge/metrics/
          ├── by_outcome_type.json        # Growth, efficiency, quality, innovation metrics
          ├── by_stakeholder.json         # Customer, employee, partner, investor metrics
          ├── leading_lagging.json        # Classification and balancing guidance
          └── measurement_methods.json    # How to collect and validate different metrics
        </metrics_library>

        <templates_system>
          data/knowledge/templates/
          ├── common_objectives.json      # Templated objectives for frequent scenarios
          ├── okr_patterns.json          # Complete OKR sets for typical situations
          ├── industry_starters.json     # Industry-specific starting points
          └── transformation_paths.json  # Progressive OKR evolution patterns
        </templates_system>
      </knowledge_structure>

      <content_requirements>
        <example_quality_standards>
          Each example must include:
          - Original (poor) version with specific problems identified
          - Improved (good) version with clear outcome focus
          - Context explanation (industry, company size, situation)
          - Quality score breakdown showing improvement
          - Implementation guidance and success factors
        </example_quality_standards>

        <coverage_requirements>
          - 50+ high-quality example pairs per major industry (300+ total)
          - 30+ anti-pattern types with detection rules and reframing strategies
          - 200+ metric suggestions organized by outcome type and measurement method
          - 25+ complete OKR templates for common business scenarios
          - Cross-references enabling intelligent navigation between related content
        </coverage_requirements>
      </content_requirements>

      <acceptance_criteria>
        - Knowledge base covers all major industries and business functions
        - Each example includes context, quality analysis, and implementation guidance
        - Anti-patterns have reliable detection rules and effective reframing strategies
        - Metric suggestions are specific, measurable, and contextually relevant
        - Templates provide helpful starting points without constraining creativity
        - Content quality validated by OKR experts and business practitioners
      </acceptance_criteria>
    </deliverable>

    <deliverable priority="critical">
      <title>Intelligent Knowledge Retrieval System</title>
      <description>Context-aware system for selecting and presenting relevant knowledge during conversations</description>
      <retrieval_components>
        <context_analyzer>
          - Industry detection from user input and conversation context
          - Function/role identification from mentioned responsibilities
          - Company size and type inference from described challenges
          - OKR maturity level assessment from user responses
          - Communication style adaptation based on user preferences
        </context_analyzer>

        <example_selector>
          - Relevance scoring based on context match (industry, function, situation)
          - Quality filtering ensuring only high-rated examples shown
          - Diversity promotion to avoid repetitive suggestions
          - Timing optimization to show examples when most helpful
          - Negative example inclusion when illustrating what to avoid
        </example_selector>

        <pattern_matcher>
          - Anti-pattern recognition using multiple detection methods
          - Confidence scoring for pattern matches
          - Context-sensitive pattern selection (some patterns more common in certain industries)
          - Progressive escalation from gentle nudges to explicit correction
          - Success tracking for pattern recognition and reframing effectiveness
        </pattern_matcher>

        <suggestion_engine>
          - Metric recommendation based on objective analysis
          - Template suggestion for common scenarios
          - Best practice tips tailored to user context
          - Alternative approach presentation when users seem stuck
          - Progressive guidance from basic to sophisticated measurement approaches
        </suggestion_engine>
      </retrieval_components>

      <integration_interfaces>
        <conversation_manager_integration>
          interface KnowledgeRequest {
            context: ConversationContext;
            phase: ConversationPhase;
            userInput: string;
            currentOKRs: OKRDraft[];
            requestType: 'examples' | 'anti_patterns' | 'metrics' | 'templates' | 'best_practices';
          }

          interface KnowledgeResponse {
            suggestions: KnowledgeSuggestion[];
            confidence: number;
            displayTiming: 'immediate' | 'after_response' | 'on_request';
            integration: 'inline' | 'sidebar' | 'modal';
          }
        </conversation_manager_integration>

        <frontend_integration>
          - Real-time suggestion delivery through WebSocket
          - Contextual help panels integrated with conversation flow
          - Example library browser for user exploration
          - Suggestion acceptance/rejection feedback collection
          - Progressive disclosure based on user engagement level
        </frontend_integration>
      </integration_interfaces>

      <acceptance_criteria>
        - Context analysis accurately identifies user industry and function (>85% accuracy)
        - Example selection relevance rated highly by test users (>8/10 relevance score)
        - Anti-pattern detection catches common mistakes reliably (>90% detection rate)
        - Suggestion timing enhances rather than interrupts conversation flow
        - Knowledge integration improves overall conversation quality scores by >15 points
      </acceptance_criteria>
    </deliverable>

    <deliverable priority="high">
      <title>Enhanced Conversation Integration</title>
      <description>Seamless integration of knowledge systems with existing conversation flow</description>
      <integration_strategies>
        <contextual_examples>
          - Automatic example insertion when anti-patterns detected
          - Industry-specific example rotation to avoid repetition
          - Good/bad comparison presentation with clear explanations
          - User-requested example exploration without breaking flow
          - Example relevance explanation to build understanding
        </contextual_examples>

        <progressive_coaching>
          - Gentle guidance escalating to explicit correction as needed
          - Success celebration when users demonstrate understanding
          - Context-aware repetition avoidance for experienced users
          - Skill level adaptation based on user responses and progress
          - Knowledge scaffolding from basic concepts to advanced techniques
        </progressive_coaching>

        <intelligent_prompting>
          - Enhanced Claude prompts incorporating relevant knowledge
          - Dynamic prompt construction based on available examples
          - Context-sensitive instruction modification for different user types
          - Knowledge-informed response validation and enhancement
          - Continuous prompt optimization based on success patterns
        </intelligent_prompting>

        <user_agency_preservation>
          - Optional knowledge presentation (users can decline suggestions)
          - Multiple example options when available
          - Clear distinction between system suggestions and requirements
          - User preference learning for future knowledge presentation
          - Respect for user expertise and alternative approaches
        </user_agency_preservation>
      </integration_strategies>

      <enhanced_conversation_flow>
        <discovery_phase_enhancements>
          - Industry template suggestions when appropriate
          - Common challenge patterns for user's context
          - Success story inspiration from similar organizations
          - Stakeholder consideration prompts based on industry norms
        </discovery_phase_enhancements>

        <refinement_phase_enhancements>
          - Before/after example pairs for objective improvement
          - Outcome language suggestions with industry context
          - Inspiration examples from user's industry
          - Alternative framing options when users struggle
        </refinement_phase_enhancements>

        <kr_discovery_enhancements>
          - Metric suggestion menus organized by outcome type
          - Industry-standard measurement approaches
          - Leading/lagging indicator balance guidance
          - Baseline and target range suggestions based on benchmarks
        </kr_discovery_enhancements>

        <validation_phase_enhancements>
          - Comparison with best-practice examples
          - Industry benchmark context for quality scores
          - Implementation success factors from similar organizations
          - Next-step guidance based on proven patterns
        </validation_phase_enhancements>
      </enhanced_conversation_flow>

      <acceptance_criteria>
        - Knowledge integration feels natural and helpful (not intrusive or robotic)
        - Conversation quality scores improve by >15 points with knowledge enhancement
        - User engagement increases (longer conversations, more questions, better outcomes)
        - Knowledge presentation adapts effectively to different user types and contexts
        - System provides value to both OKR novices and experienced practitioners
      </acceptance_criteria>
    </deliverable>

    <deliverable priority="high">
      <title>Frontend Knowledge Integration</title>
      <description>User interface enhancements supporting knowledge system presentation</description>
      <ui_components>
        <knowledge_panel>
          - Collapsible sidebar showing contextual suggestions
          - Tabbed interface for examples, patterns, metrics, templates
          - Search functionality for knowledge exploration
          - Bookmark system for useful examples and patterns
          - Integration with main conversation flow
        </knowledge_panel>

        <inline_suggestions>
          - Contextual tooltips with brief explanations
          - Expandable example cards within conversation
          - Suggestion chips for quick selection
          - Comparison views for good vs bad examples
          - Progressive disclosure to avoid overwhelming users
        </inline_suggestions>

        <example_browser>
          - Filterable library of all examples by industry, function, quality
          - Detailed view with context, analysis, and implementation guidance
          - Related examples and cross-reference navigation
          - User rating and feedback collection
          - Export capability for organizational knowledge sharing
        </example_browser>

        <pattern_explanation>
          - Visual highlighting of detected anti-patterns
          - Step-by-step reframing guidance
          - Before/after comparison with quality score changes
          - Alternative approach suggestions with trade-off analysis
          - Success tracking for different reframing strategies
        </pattern_explanation>
      </ui_components>

      <interaction_design>
        <non_intrusive_presentation>
          - Knowledge appears when helpful, not disruptive
          - User control over knowledge panel visibility
          - Subtle indicators for available suggestions
          - Respect for user focus during active typing/thinking
          - Optional detail levels (overview → detailed analysis)
        </non_intrusive_presentation>

        <contextual_relevance>
          - Industry/function badges on examples for quick relevance assessment
          - Confidence indicators showing how well suggestions match user context
          - Freshness indicators for recently updated or trending examples
          - User feedback integration affecting future suggestion relevance
          - Adaptive presentation based on user engagement patterns
        </contextual_relevance>
      </interaction_design>

      <acceptance_criteria>
        - Knowledge presentation enhances conversation without interrupting flow
        - Users can easily find relevant examples and patterns when needed
        - Interface adapts to user preferences and engagement patterns
        - Knowledge integration improves user confidence and OKR quality
        - System scales gracefully as knowledge base grows
      </acceptance_criteria>
    </deliverable>

    <deliverable priority="medium">
      <title>Knowledge Management System</title>
      <description>Tools for maintaining, updating, and improving the knowledge base</description>
      <management_capabilities>
        <content_curation>
          - Quality scoring for knowledge base entries
          - Usage analytics showing most/least helpful content
          - User feedback integration for content improvement
          - Expert review workflow for new examples and patterns
          - Version control for knowledge base updates
        </content_curation>

        <performance_monitoring>
          - Suggestion relevance tracking and optimization
          - Pattern detection accuracy measurement and improvement
          - Knowledge presentation effectiveness analysis
          - User engagement correlation with knowledge quality
          - A/B testing framework for knowledge delivery approaches
        </performance_monitoring>

        <continuous_improvement>
          - Automated pattern discovery from conversation logs
          - Suggestion effectiveness learning and optimization
          - Knowledge gap identification from user struggles
          - Content freshness monitoring and update alerts
          - Community contribution framework for knowledge expansion
        </continuous_improvement>
      </management_capabilities>

      <acceptance_criteria>
        - Knowledge base quality improves over time through usage feedback
        - Content curation process maintains high quality standards
        - Performance monitoring enables data-driven knowledge optimization
        - System supports scalable knowledge base growth and maintenance
      </acceptance_criteria>
    </deliverable>
  </phase_deliverables>

  <implementation_steps>
    <step order="1" duration="12 hours">
      <title>Knowledge Base Content Creation</title>
      <actions>
        - Research and compile high-quality OKR examples from diverse industries
        - Create comprehensive anti-pattern database with detection rules
        - Build metrics library organized by outcome types and measurement approaches
        - Develop template system for common OKR scenarios
        - Validate content quality with expert review and testing
      </actions>
      <focus_areas>
        - Content quality over quantity - each example must be genuinely helpful
        - Industry diversity ensuring broad applicability
        - Clear before/after transformations showing improvement paths
        - Practical implementation guidance beyond just examples
      </focus_areas>
      <validation>Knowledge base covers all major industries with high-quality, expert-validated content</validation>
    </step>

    <step order="2" duration="10 hours">
      <title>Intelligent Retrieval System Implementation</title>
      <actions>
        - Build context analysis engine for industry/function detection
        - Implement example selection algorithm with relevance scoring
        - Create pattern matching system with confidence assessment
        - Develop suggestion engine for metrics, templates, and best practices
        - Integrate retrieval system with conversation flow
      </actions>
      <focus_areas>
        - Accurate context detection from user input and conversation history
        - Relevant example selection that truly matches user situation
        - Reliable anti-pattern detection without excessive false positives
        - Smooth integration preserving conversation naturalness
      </focus_areas>
      <validation>Retrieval system provides relevant, timely suggestions that enhance conversation quality</validation>
    </step>

    <step order="3" duration="8 hours">
      <title>Conversation Flow Enhancement</title>
      <actions>
        - Integrate knowledge suggestions into existing conversation phases
        - Enhance Claude prompts with contextual knowledge incorporation
        - Implement progressive coaching with escalating guidance levels
        - Build user agency preservation with optional suggestion acceptance
        - Test enhanced flow with various user scenarios
      </actions>
      <focus_areas>
        - Natural knowledge integration that enhances rather than interrupts
        - Context-appropriate suggestion timing and presentation
        - Respect for user expertise while providing valuable guidance
        - Maintained conversation quality with knowledge enhancement
      </focus_areas>
      <validation>Enhanced conversation flow improves quality scores and user engagement</validation>
    </step>

    <step order="4" duration="6 hours">
      <title>Frontend Knowledge Integration</title>
      <actions>
        - Create knowledge panel component with tabbed interface
        - Implement inline suggestion system with contextual tooltips
        - Build example browser with filtering and search capabilities
        - Add pattern explanation interface with visual highlighting
        - Integrate knowledge UI with existing conversation interface
      </actions>
      <focus_areas>
        - Non-intrusive knowledge presentation preserving conversation focus
        - Intuitive interface enabling easy knowledge exploration
        - Visual clarity distinguishing suggestions from requirements
        - Responsive design maintaining usability across devices
      </focus_areas>
      <validation>Frontend knowledge integration provides accessible, helpful guidance without disruption</validation>
    </step>

    <step order="5" duration="4 hours">
      <title>Performance Optimization and Testing</title>
      <actions>
        - Optimize knowledge retrieval performance for real-time suggestions
        - Test suggestion relevance across different user scenarios
        - Validate anti-pattern detection accuracy and reframing effectiveness
        - Performance test with large knowledge base and concurrent users
        - Conduct user testing for knowledge integration effectiveness
      </actions>
      <focus_areas>
        - Real-time performance maintaining conversation responsiveness
        - High relevance and accuracy of knowledge suggestions
        - User satisfaction with knowledge integration
        - Scalability as knowledge base grows
      </focus_areas>
      <validation>Knowledge system performs efficiently and provides demonstrable value to users</validation>
    </step>
  </implementation_steps>

  <technical_specifications>
    <knowledge_base_schema>
      <example_structure>
        interface OKRExample {
          id: string;
          category: 'industry' | 'function' | 'universal';
          context: {
            industry: string[];
            function: string[];
            company_size: 'startup' | 'scale' | 'enterprise';
            situation: string;
          };
          poor_version: {
            objective: string;
            key_results: string[];
            problems: string[];
            quality_score: number;
          };
          good_version: {
            objective: string;
            key_results: string[];
            improvements: string[];
            quality_score: number;
          };
          explanation: {
            transformation_rationale: string;
            key_insights: string[];
            implementation_tips: string[];
          };
          metadata: {
            source: string;
            expert_validated: boolean;
            usage_count: number;
            effectiveness_score: number;
            last_updated: Date;
          };
        }
      </example_structure>

      <anti_pattern_structure>
        interface AntiPattern {
          id: string;
          name: string;
          description: string;
          detection: {
            keywords: string[];
            regex_patterns: RegExp[];
            contextual_rules: Rule[];
          };
          examples: {
            triggers: string[];
            contexts: string[];
          };
          reframing: {
            strategy: 'five_whys' | 'outcome_focus' | 'stakeholder_value' | 'measurement_driven';
            questions: string[];
            example_transformations: Transformation[];
          };
          metadata: {
            severity: 'low' | 'medium' | 'high' | 'critical';
            frequency: number;
            success_rate: number;
          };
        }
      </anti_pattern_structure>

      <metric_suggestion_structure>
        interface MetricSuggestion {
          id: string;
          name: string;
          description: string;
          category: 'growth' | 'efficiency' | 'quality' | 'innovation' | 'satisfaction';
          type: 'leading' | 'lagging' | 'both';
          measurement: {
            method: string;
            data_sources: string[];
            calculation: string;
            baseline_guidance: string;
            target_setting: string;
          };
          applicability: {
            industries: string[];
            functions: string[];
            contexts: string[];
          };
          examples: {
            good_usage: string[];
            poor_usage: string[];
            implementation_notes: string[];
          };
        }
      </metric_suggestion_structure>
    </knowledge_base_schema>

    <retrieval_system_architecture>
      <context_analyzer>
        class ContextAnalyzer {
          analyzeIndustry(userInput: string, conversationHistory: Message[]): IndustryContext;
          analyzeFunction(userInput: string, conversationHistory: Message[]): FunctionContext;
          analyzeSituation(userInput: string, conversationHistory: Message[]): SituationContext;
          calculateContextConfidence(context: Context): number;

          private extractKeywords(text: string): string[];
          private matchIndustryPatterns(keywords: string[]): IndustryMatch[];
          private inferCompanySize(context: Context): CompanySize;
          private assessOKRMaturity(conversationHistory: Message[]): MaturityLevel;
        }
      </context_analyzer>

      <example_selector>
        class ExampleSelector {
          selectRelevantExamples(
            context: Context,
            requestType: ExampleType,
            maxExamples: number = 3
          ): ScoredExample[];

          private calculateRelevanceScore(example: OKRExample, context: Context): number;
          private ensureDiversity(examples: ScoredExample[]): ScoredExample[];
          private filterByQuality(examples: ScoredExample[], minQuality: number): ScoredExample[];
          private trackUsageAndEffectiveness(selectedExamples: ScoredExample[]): void;
        }
      </example_selector>

      <suggestion_engine>
        class SuggestionEngine {
          generateSuggestions(
            context: Context,
            phase: ConversationPhase,
            currentOKRs: OKRDraft[]
          ): KnowledgeSuggestion[];

          private suggestMetrics(objective: string, context: Context): MetricSuggestion[];
          private recommendTemplates(context: Context): TemplateSuggestion[];
          private provideBestPractices(phase: ConversationPhase, context: Context): BestPractice[];
          private determineDisplayTiming(suggestion: KnowledgeSuggestion): DisplayTiming;
        }
      </suggestion_engine>
    </retrieval_system_architecture>

    <integration_interfaces>
      <conversation_manager_integration>
        // Enhanced ConversationManager with knowledge integration
        class ConversationManager {
          private knowledgeSystem: KnowledgeSystem;

          async processMessage(sessionId: string, message: string): Promise<EnhancedResponse> {
            const session = this.getSession(sessionId);
            const context = this.contextAnalyzer.analyze(message, session.history);

            // Detect anti-patterns and get reframing suggestions
            const patterns = this.knowledgeSystem.detectPatterns(message, context);

            // Get relevant examples and suggestions
            const knowledge = this.knowledgeSystem.getSuggestions(context, session.phase);

            // Enhanced prompt with knowledge integration
            const enhancedPrompt = this.buildKnowledgeEnhancedPrompt(
              message, session, patterns, knowledge
            );

            const response = await this.claude.complete(enhancedPrompt);

            return {
              ...response,
              knowledge: knowledge,
              patterns: patterns,
              suggestions: this.knowledgeSystem.formatSuggestions(knowledge, context)
            };
          }
        }
      </conversation_manager_integration>

      <frontend_integration>
        // React components for knowledge display
        interface KnowledgePanelProps {
          suggestions: KnowledgeSuggestion[];
          context: Context;
          onSuggestionSelect: (suggestion: KnowledgeSuggestion) => void;
        }

        const KnowledgePanel: React.FC<KnowledgePanelProps> = ({
          suggestions,
          context,
          onSuggestionSelect
        }) => {
          return (
            <Card className="knowledge-panel">
              <Tabs>
                <TabsList>
                  <TabsTrigger value="examples">Examples</TabsTrigger>
                  <TabsTrigger value="patterns">Patterns</TabsTrigger>
                  <TabsTrigger value="metrics">Metrics</TabsTrigger>
                  <TabsTrigger value="templates">Templates</TabsTrigger>
                </TabsList>
                <TabsContent value="examples">
                  <ExampleList examples={suggestions.examples} context={context} />
                </TabsContent>
                {/* Other tabs */}
              </Tabs>
            </Card>
          );
        };
      </frontend_integration>
    </integration_interfaces>
  </technical_specifications>

  <validation_gates>
    <gate name="knowledge_base_complete">
      <criteria>
        - 300+ high-quality OKR examples across all major industries
        - 30+ anti-pattern types with reliable detection rules
        - 200+ metric suggestions with implementation guidance
        - 25+ complete OKR templates for common scenarios
        - Expert validation completed for all content
        - Cross-reference system enabling intelligent navigation
      </criteria>
      <quality_checks>
        - Expert review of sample content from each category
        - Relevance testing with target user scenarios
        - Quality score validation against established rubric
        - Completeness audit ensuring comprehensive coverage
      </quality_checks>
    </gate>

    <gate name="retrieval_system_accuracy">
      <criteria>
        - Context detection accuracy >85% for industry and function identification
        - Example relevance rated >8/10 by test users
        - Anti-pattern detection >90% accuracy with <10% false positives
        - Suggestion timing enhances conversation flow without disruption
        - Knowledge integration improves quality scores by >15 points average
      </criteria>
      <test_scenarios>
        - Technology startup product manager creating growth OKRs
        - Healthcare operations director focusing on efficiency
        - Retail marketing manager developing customer acquisition goals
        - Manufacturing quality lead building process improvement OKRs
        - Financial services compliance officer creating risk management OKRs
      </test_scenarios>
    </gate>

    <gate name="conversation_enhancement_quality">
      <criteria>
        - Enhanced conversations feel natural and helpful (not robotic)
        - Knowledge presentation times appropriately with conversation flow
        - User engagement increases (longer sessions, more questions, better outcomes)
        - Quality scores improve consistently across different user types
        - System adds value for both novice and experienced OKR practitioners
      </criteria>
      <user_testing>
        - A/B test comparing conversations with/without knowledge enhancement
        - User satisfaction surveys specifically about knowledge helpfulness
        - Quality score comparison before/after knowledge integration
        - Engagement metric analysis (session length, question frequency, outcome quality)
      </user_testing>
    </gate>

    <gate name="frontend_integration_seamless">
      <criteria>
        - Knowledge panel integrates smoothly with existing interface
        - Inline suggestions appear contextually without disrupting flow
        - Example browser provides easy exploration without leaving conversation
        - Pattern explanations help users understand improvements
        - All knowledge features work responsively on desktop and tablet
      </criteria>
      <interface_testing>
        - Usability testing for knowledge panel navigation
        - Accessibility testing for new knowledge components
        - Responsive design testing across target devices
        - Performance testing with large knowledge datasets
      </interface_testing>
    </gate>
  </validation_gates>

  <success_criteria>
    <primary_success>
      ✅ Comprehensive knowledge base with expert-validated, industry-specific content
      ✅ Intelligent retrieval system providing contextually relevant suggestions
      ✅ Seamless conversation integration enhancing coaching without disruption
      ✅ Frontend knowledge presentation supporting exploration and learning
      ✅ Measurable improvement in conversation quality and user outcomes
    </primary_success>

    <knowledge_quality_targets>
      - Knowledge base covers 8+ industries and 5+ business functions comprehensively
      - Example relevance rated >8/10 by users in appropriate contexts
      - Anti-pattern detection accuracy >90% with effective reframing strategies
      - Metric suggestions provide helpful starting points >85% of the time
      - Templates accelerate OKR creation without constraining creativity
    </knowledge_quality_targets>

    <integration_effectiveness_targets>
      - Knowledge enhancement improves overall quality scores by >15 points
      - User engagement increases (session length +25%, questions asked +40%)
      - Conversation completion rate improves (fewer abandoned sessions)
      - User satisfaction specifically with knowledge coaching >8.5/10
      - System provides value across experience levels (novice to expert)
    </integration_effectiveness_targets>
  </success_criteria>

  <handoff_to_phase_5>
    <deliverables_required>
      - Complete knowledge base with comprehensive content coverage
      - Intelligent retrieval system integrated with conversation flow
      - Enhanced frontend supporting knowledge presentation and exploration
      - Conversation quality improvement demonstrated through testing
      - Knowledge management foundation prepared for continuous improvement
    </deliverables_required>

    <analytics_integration_points>
      Phase 5 analytics system must track:
      - Knowledge suggestion effectiveness and user acceptance rates
      - Content usage patterns showing most/least valuable knowledge
      - User learning progression and knowledge gap identification
      - Conversation improvement correlation with knowledge integration
      - Expert feedback loops for continuous knowledge base improvement
    </analytics_integration_points>

    <learning_system_preparation>
      - Usage tracking infrastructure for all knowledge interactions
      - Feedback collection mechanisms for suggestion quality
      - Pattern recognition foundation for automated knowledge discovery
      - A/B testing framework for knowledge delivery optimization
      - User preference learning for personalized knowledge presentation
    </learning_system_preparation>
  </handoff_to_phase_5>

  <recovery_procedures>
    <if_content_creation_overwhelming>
      - Focus on 3 major industries (tech, healthcare, financial services)
      - Reduce anti-pattern types to most critical 15 patterns
      - Implement basic metric suggestions without advanced categorization
      - Use simple templates without sophisticated contextual adaptation
    </if_content_creation_overwhelming>

    <if_retrieval_accuracy_insufficient>
      - Implement keyword-based matching instead of sophisticated analysis
      - Use manual tagging for examples instead of automated categorization
      - Reduce suggestion complexity, focus on most obvious pattern matches
      - Accept lower relevance scores with plan for post-launch improvement
    </if_retrieval_accuracy_insufficient>

    <if_integration_disrupts_conversation>
      - Move knowledge to completely separate interface (no inline suggestions)
      - Make all knowledge optional and user-requested only
      - Simplify presentation to basic example lists without sophisticated formatting
      - Focus on post-conversation knowledge exploration rather than inline coaching
    </if_integration_disrupts_conversation>

    <rollback_criteria>
      - Knowledge integration reduces conversation quality or user satisfaction
      - Retrieval system cannot achieve >70% relevance in testing
      - Content creation cannot reach minimum coverage requirements
      - Frontend integration proves technically incompatible with existing interface
    </rollback_criteria>
  </recovery_procedures>
</task>